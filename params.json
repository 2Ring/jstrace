{"name":"JsTrace","tagline":"JavaScript Diagnostic Tracing Library","body":"# Overview\r\n\r\n[JsTrace](https://github.com/tommck/jstrace \"JsTrace\") is a pure JavaScript library that enables you to set separate \"switch levels\" on various components within your JavaScript code in order to facilitate debugging without all the \"noise\" of debugging information you don't want to see at the moment\r\n\r\n**NOTE:** This is now available as a [NuGet Package ](http://nuget.org/packages/JsTrace \"NuGet package\")too!\r\n\r\n**UPDATE:** JsTrace now has a companion, JsTrace.MVC whichs allows you to proxy JsTrace messages to the web server in ASP.NET MVC. The code is here as well. ([NuGet Package](http://nuget.org/packages/JsTrace.MVC \"NuGet Package\"))\r\n\r\n# Switches\r\n\r\nThere are six switch levels, which are (in order of least->most information):\r\n\r\n* off\r\n* error (default)\r\n* warn\r\n* info\r\n* debug\r\n* log\r\n\r\nSome of you may notice that these correspond directly with methods on the \"console\" objects supported in many browsers.\r\n\r\nThanks to some magic by [Ben Alman](http://benalman.com/ \"Ben Alman\"), if your browser does not support these methods, your messages will not be ignored.\r\n\r\n# Instrumenting Your Scripts\r\n\r\nTo do basic instrumentation, you just declare a Trace object and use like this:\r\n\r\n\r\n\tvar tracer = new Trace('ModuleName');\r\n\ttracer.info('Testing tracing capabilities');\r\n\ttracer.debug('More detail about the tracing capabilities');\r\n\ttracer.log('Even MORE detail'); \r\n\ttracer.warn('Seriously, this is too much testing!');\r\n\ttracer.error('That is it! I am done!');\r\n\r\nIn Chrome, by default, this code results in the following output to the Console:\r\n\r\n![error](http://download.codeplex.com/Download?ProjectName=jstrace&DownloadId=343857)\r\n\r\nIf you were to set the switch to \"log\" level (highest setting),\r\n\r\n\tTrace.setLevel('ModuleName', Trace.Levels.log);\r\nYou get this:\r\n\r\n ![all levels of errors](http://download.codeplex.com/Download?ProjectName=jstrace&DownloadId=343859)\r\n\r\n# Using Callbacks\r\n\r\nJsTrace has support for a callback method that is called upon every trace message sent, settings-be-damned.\r\n\r\nSo, if you don't like all this fancy logging stuff and you want to go back to using alerts, you could do this:\r\n\r\n\tTrace.setCallback(\r\n\t   function(module, level) { \r\n\t      var args = Array.prototype.slice.apply(arguments).slice(2);\r\n\t      alert(module + ':[' + level + '] ' + args.join(' '));\r\n   \t}, \r\n   \ttrue,\r\n\t0);\r\n\r\n\r\nResults:\r\n\r\n ![error dialog](http://download.codeplex.com/Download?ProjectName=jstrace&DownloadId=343861)\r\n \r\n\r\nYou'll notice above that I passed 3 parameters to setCallback.\r\n\r\n## Callback Parameters\r\n\r\n### The Callback\r\n\r\na JavaScript function whose parameters are:\r\n\r\n* the module name\r\n* the level\r\n* the message passed, followed by every other parameter passed\r\n\r\n### Force Flag\r\n\r\nBy default, the callback will only be invoked if the browser does not have support for console or console.log.\r\n\r\nif this flag is a Boolean \"true\", all messages will be sent to the callback, regardless of browser support\r\n\r\n### Historical Message Limit\r\n\r\nInternally, the Trace library keeps a common log history in memory.\r\n\r\nIf you do not specify a limit, your callback will be called for every message that was logged before your callback was set.\r\n\r\nIf you do, you will receive up to \"limit\" number of calls for the most recent traced messages.\r\n\r\n#Cool Callback Tricks\r\n\r\n##Logging To Your Server\r\n\r\nIf you happen to work on a developer unfriendly platform (*cough*iPad*cough*), you could set up a callback to log all messages to your server like this:\r\n\r\n\tTrace.setCallback(\r\n\t   function(module, level) { \r\n\t        var args = Array.prototype.slice.apply(arguments).slice(2);\r\n\t\r\n\t        // (Optionally) filter by module/trace level\r\n\t        if (Trace.shouldTrace(parms.module, parms.level) == true) {\r\n\t            $.ajax({\r\n\t                async: true, // fire and forget\r\n\t                type: \"POST\",\r\n\t                url: '/Log/jsLog',\r\n\t                data: { \r\n\t                   module: module, \r\n\t                   level: level, \r\n\t                   message: args.join(' ') \r\n\t                },\r\n\t                contentType: 'application/json',\r\n\t                dataType: 'json'\r\n\t            });\r\n\t        }\r\n\t    }, \r\n\t    true,\r\n\t    0);\r\nI've used this approach more than once to find a particularly difficult bug on the iPad\r\n\r\n##On Error: Send History To Server\r\n\r\n\ttry {\r\n\t    // some code that shouldn't throw an exception\r\n\t}\r\n\tcatch (err) {\r\n\t    // TODO: pop up modal \"An error has occurred, \r\n\t    // sending details to our server...\"\r\n\t    var allMessages = [];\r\n\t    // get every trace message and append it to the allMessages Array\r\n\t    Trace.setCallback(function (module, level) {\r\n\t        var args = Array.prototype.slice.apply(arguments).slice(2);\r\n\t        var msg = module + ' [' + level + '] - ' + args.join(' ');\r\n\t        allMessages.push(msg);\r\n\t    },\r\n\t    true);\r\n\t\r\n\t    // remove the callback\r\n\t    Trace.setCallback();\r\n\t\r\n\t    // post this to the server\r\n\t    $.ajax({\r\n\t        async: true,\r\n\t        type: \"POST\",\r\n\t        url: '/Log/jsExceptionLog',\r\n\t        data: { \r\n\t           message: 'An Unexpected Error Occurred',\r\n\t           logHistory: allMessages \r\n\t        },\r\n\t        contentType: 'application/json',\r\n\t        dataType: 'json'\r\n\t    })\r\n\t    .complete(function () {\r\n\t        // TODO: hide the popup\r\n\t    });\r\n\t}\r\nASP.NET Devs: If you're planning on proxying JsTrace messages to the server, check out the [JsTrace.MVC NuGet package ](http://nuget.org/packages/JsTrace.MVC \"JsTrace.MVC NuGet package\")I made to make this easier","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}